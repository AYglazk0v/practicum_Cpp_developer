<details>
<summary>Теория +  тестирование: </summary>

# Хранение объектов в памяти

C++ — язык программирования высокого уровня, позволяющий создавать программы для разных программно-аппаратных платформ — от микроконтроллеров и мобильных телефонов до суперкомпьютеров.

Архитектурные различия между этими платформами значительны: набор инструкций процессора, устройство памяти, организация ввода-вывода с внешними устройствами. Компилятор берёт на себя заботу о том, как преобразовать программу в машинный код для целевой платформы, а стандартная библиотека предоставляет надёжные компоненты, подходящие для решения повседневных задач.

Сильная сторона C++ в том, что, когда стандартные решения не подходят, язык даёт вам возможность «спуститься» на более низкий уровень, ближе к железу, чтобы оптимально распорядиться ресурсами компьютера.

### Модель памяти C++

Один из таких ресурсов — память, которая используется для хранения кода программы и обработки её данных. Чтобы код на C++ мог выполняться на разных программно-аппаратных платформах, язык предоставляет программисту модель памяти ******— абстракцию, скрывающую особенности работы с памятью на конкретной платформе.

С точки зрения C++ память компьютера состоит из одной или нескольких непрерывных последовательностей ячеек. Эти ячейки называются байтами.

Байт — минимальная адресуемая единица памяти. В большинстве современных компьютеров каждый байт состоит из восьми двоичных разрядов, называемых битами, что позволяет ему принимать 2^8=256 различных значений. Каждый байт в памяти имеет уникальный адрес — числовое значение, задающее его местоположение в памяти.

![1.png](https://github.com/AYglazk0v/practicum_Cpp_developer/blob/main/sprint6/%D0%9C%D0%BE%D0%B4%D0%B5%D0%BB%D1%8C_%D0%BF%D0%B0%D0%BC%D1%8F%D1%82%D0%B8/%D0%A5%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D0%BE%D0%B2_%D0%B2_%D0%BF%D0%B0%D0%BC%D1%8F%D1%82%D0%B8/img/1.png?raw=true)

_Схематичное представление памяти программы. В ячейке с адресом  `0x400018`  находится байт со значением  `42`. Значения остальных ячеек памяти для примера не важны, поэтому на рисунке их нет_

Префикс  `0x`  говорит о том, что целое число записано в шестнадцатеричной системе счисления. Эта система счисления часто используется для записи адресов, так как «круглые» числа в ней — это степени числа 16, которые также можно представить как степени двойки.

### Объекты в памяти

Программы на C++ не манипулируют содержимым ячеек памяти напрямую. Вместо этого они работают с объектами — создают, разрушают их, считывают и модифицируют состояние объектов. В данной теме под термином «объект» будем по умолчанию подразумевать понятие не из объектно-ориентированного программирования, а более абстрактное. Объектом ****в C++ называется регион в памяти, который обладает такими свойствами:

-   **Размер в байтах**. Типы  `char`,  `unsigned char`,  `int8_t`,  `uint8_t`  и  `std::byte`  занимают ровно один байт памяти, а другие типы могут требовать несколько байтов. Например, значение типа  `int`  в программах, компилируемых для 32-разрядных процессоров, может занимать в памяти четыре байта, а для 16-разрядных — два. Узнать, сколько байтов занимает тип или переменная, позволяет операция  `sizeof`.
-   **Требования к выравниванию в памяти**. Выравнивание — степень двойки, число, равное количеству байтов между адресами, по которым могут размещаться объекты данного типа. Операция  `alignof`  возвращает значение выравнивания для заданного типа на целевой платформе. В общем случае оно может отличаться от размера объекта, возвращаемого  `sizeof`  как в меньшую, так и в большую сторону.
-   **Тип**. Позволяет программе правильно работать с областью памяти, которую объект занимает. Например, несмотря на то, что размеры типов  `float`  и  `int`  могут совпадать, для работы с ними компилятор генерирует различающийся машинный код.
-   **Значение**, которое определяется содержимым области памяти, занимаемой объектом. Значение может быть неопределённым — например, при объявлении неинициализированной локальной переменной примитивного типа данных, такого как  `int`  или  `char`.
-   **Продолжительность времени жизни**. Например, время жизни локальных переменных ограничено блоком, внутри которого они объявлены, а глобальных переменных — продолжительностью работы программы.
-   Опциональное  **имя**. Имя позволяет обращаться к объекту в программе. Простейший пример — имя переменной. Имя может отсутствовать у временного объекта, который создают как промежуточный результат вычислений. Один объект может быть доступен по нескольким именам. Так, например, ссылка создаст ещё одно имя для уже существующего объекта.

На рисунке ниже — четыре объекта в памяти программы: переменная  `p`  типа  `Point`, целое число  `age`, переменная  `weight`  типа  `double`  и неинициализированная переменная  `year`  типа  `int16_t`. Ссылка на объект  `p`  позволяет обратиться к нему по альтернативному имени  `p_ref`.

![2.png](https://github.com/AYglazk0v/practicum_Cpp_developer/blob/main/sprint6/%D0%9C%D0%BE%D0%B4%D0%B5%D0%BB%D1%8C_%D0%BF%D0%B0%D0%BC%D1%8F%D1%82%D0%B8/%D0%A5%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D0%BE%D0%B2_%D0%B2_%D0%BF%D0%B0%D0%BC%D1%8F%D1%82%D0%B8/img/2.png?raw=true)

_Пример расположения объектов различных типов в памяти. Ссылка  `p_ref`  указывает на объект переменной  `p`_

Каждый из этих объектов имеет представление в памяти, специфичное для некоторой платформы. Компилятор отвечает за корректное чтение и запись значений объектов в память.

----------

Посмотрите на иллюстрацию и определите, какие данные располагаются по адресу 0x0000000000400028.

-   Целое число 12, четыре байта.
    
-   Целое число 18, четыре байта.
    
-   Целое число 18, восемь байт.
    
-   Число с плавающей точкой 75.3, четыре байта.
    
-   Число с плавающей точкой 75.3, восемь байт.
    
-   Никакие — пустое пространство.
    

Следующая программа выводит размеры и величину выравнивания для некоторых стандартных и пользовательских типов на целевой платформе:

```cpp
#include <cstddef>  // cstddef необходим для использования std::byte
#include <cstdint>  // cstdint необходим для использования uint32_t и int64_t
#include <iostream>

using namespace std;

struct Sportsman {
    int id;
    double height;
};

int main() {
    cout << "char: size="s << sizeof(char) << ", alignment="s << alignof(char) << endl;
    cout << "int: size="s << sizeof(int) << ", alignment="s << alignof(int) << endl;
    cout << "double: size="s << sizeof(double) << ", alignment="s << alignof(double) << endl;
    cout << "Sportsman: size="s << sizeof(Sportsman) << ", alignment="s << alignof(Sportsman) << endl;

    return 0;
}

```

На разных платформах размеры и требования к выравниванию данных могут отличаться. Например, скомпилированная для 64-разрядной ОС Windows программа выводит следующие значения:

```
char: size=1, alignment=1
int: size=4, alignment=4
double: size=8, alignment=8
Sportsman: size=16, alignment=8

```

Размер структуры  `Sportsman`  получился больше суммарного размера её полей — компилятор добавил пустое пространство внутри структуры, чтобы её поля располагались по выровненным адресам, а размер структуры был кратен величине её выравнивания.

----------

Сколько объектов создаётся внутри функции  `main`  этой программы? Выберите один верный ответ.

```cpp
int main() {
    int x = 0;
    double n = 5;
    int& r = x;
}

```

-   Один
    
-   Два
    
-   Три
    
-   Ни одного
    

Модель памяти — абстракция. C++ вводит её, чтобы описать действия оперативной памяти без привязки к конкретной программно-аппаратной платформе.

Данные, с которыми работает программа, представляются в виде объектов — областей памяти компьютера. У этих областей есть тип, значение, размер и требования к выравниванию.

В следующем уроке вы познакомитесь с указателями — ключиком, открывающим вам низкоуровневый доступ к памяти компьютера.

</details>

<details>
<summary>Ответы:</summary>

# Ответы на задания

----------

Посмотрите на иллюстрацию и определите, какие данные располагаются по адресу 0x0000000000400028.

-   **(-)**  Целое число 12, четыре байта.
    
-   **(-)**  Целое число 18, четыре байта.
    
-   **(-)**  Целое число 18, восемь байт.
    
-   **(-)**  Число с плавающей точкой 75.3, четыре байта.
    
-   **(+)**  Число с плавающей точкой 75.3, восемь байт.
    
-   **(-)**  Никакие — пустое пространство.
    

----------

Сколько объектов создаётся внутри функции  `main`  этой программы? Выберите один верный ответ.

```cpp
int main() {
    int x = 0;
    double n = 5;
    int& r = x;
}

```

-   **(-)**  Один
    
-   **(+)**  Два
    
-   **(-)**  Три
    
-   **(-)**  Ни одного

</details>
